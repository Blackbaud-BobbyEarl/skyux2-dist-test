{"version":3,"sources":["../../../.srctemp/modules/dropdown/dropdown-menu.component.ts"],"names":[],"mappings":"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","file":"dropdown-menu.component.js","sourceRoot":"","sourcesContent":["import {\n  AfterContentInit,\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  ContentChildren,\n  EventEmitter,\n  HostListener,\n  Input,\n  OnDestroy,\n  Optional,\n  Output,\n  QueryList\n} from '@angular/core';\n\nimport { Subject } from 'rxjs/Subject';\nimport 'rxjs/add/operator/takeUntil';\n\nimport { SkyDropdownComponent } from './dropdown.component';\nimport { SkyDropdownItemComponent } from './dropdown-item.component';\n\nimport {\n  SkyDropdownMenuChange,\n  SkyDropdownMessage,\n  SkyDropdownMessageType\n} from './types';\n\n\nexport class SkyDropdownMenuComponent implements AfterContentInit, OnDestroy {\n  \n  public useNativeFocus = true;\n\n  \n  public menuChanges = new EventEmitter<SkyDropdownMenuChange>();\n\n  public get menuIndex(): number {\n    return this._menuIndex;\n  }\n\n  public set menuIndex(value: number) {\n    if (value < 0) {\n      value = this.menuItems.length - 1;\n    }\n\n    if (value >= this.menuItems.length) {\n      value = 0;\n    }\n\n    this._menuIndex = value;\n  }\n\n  \n  public menuItems: QueryList<SkyDropdownItemComponent>;\n\n  private ngUnsubscribe = new Subject();\n\n  private get hasFocusableItems(): boolean {\n    const found = this.menuItems.find(item => item.isFocusable());\n    return (found !== undefined);\n  }\n\n  private _menuIndex = 0;\n\n  constructor(\n    private changeDetector: ChangeDetectorRef,\n     private dropdownComponent: SkyDropdownComponent\n  ) { }\n\n  public ngAfterContentInit() {\n    /* istanbul ignore else */\n    if (this.dropdownComponent) {\n      this.dropdownComponent.messageStream\n        .takeUntil(this.ngUnsubscribe)\n        .subscribe((message: SkyDropdownMessage) => {\n          /* tslint:disable-next-line:switch-default */\n          switch (message.type) {\n            case SkyDropdownMessageType.Open:\n            case SkyDropdownMessageType.Close:\n            this.reset();\n            break;\n\n            case SkyDropdownMessageType.FocusFirstItem:\n            this.focusFirstItem();\n            break;\n\n            case SkyDropdownMessageType.FocusNextItem:\n            this.focusNextItem();\n            break;\n\n            case SkyDropdownMessageType.FocusPreviousItem:\n            this.focusPreviousItem();\n            break;\n          }\n        });\n\n      this.menuChanges\n        .takeUntil(this.ngUnsubscribe)\n        .subscribe((change: SkyDropdownMenuChange) => {\n          // Close the dropdown when a menu item is selected.\n          if (change.selectedItem) {\n            this.dropdownComponent.messageStream.next({\n              type: SkyDropdownMessageType.Close\n            });\n          }\n\n          if (change.items) {\n            // Update the popover style and position whenever the number of\n            // items changes.\n            this.dropdownComponent.messageStream.next({\n              type: SkyDropdownMessageType.Reposition\n            });\n          }\n        });\n    }\n\n    // Reset dropdown whenever the menu items change.\n    this.menuItems.changes\n      .takeUntil(this.ngUnsubscribe)\n      .subscribe((items: QueryList<SkyDropdownItemComponent>) => {\n        this.reset();\n        this.menuChanges.emit({\n          items: items.toArray()\n        });\n      });\n  }\n\n  public ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  \n  public onClick(event: MouseEvent) {\n    const selectedItem = this.menuItems\n      .find((item: SkyDropdownItemComponent, i: number) => {\n        const found = (item.elementRef.nativeElement.contains(event.target));\n\n        if (found) {\n          this.menuIndex = i;\n          this.menuChanges.next({\n            activeIndex: this.menuIndex\n          });\n        }\n\n        return found;\n      });\n\n    /* istanbul ignore else */\n    if (selectedItem) {\n      this.menuChanges.next({\n        selectedItem\n      });\n    }\n  }\n\n  \n  public onKeyDown(event: KeyboardEvent) {\n    const key = event.key.toLowerCase();\n\n    if (key === 'arrowdown' || key === 'down') {\n      this.focusNextItem();\n      event.preventDefault();\n    }\n\n    if (key === 'arrowup' || key === 'up') {\n      this.focusPreviousItem();\n      event.preventDefault();\n    }\n  }\n\n  public focusFirstItem() {\n    if (!this.hasFocusableItems) {\n      return;\n    }\n\n    this.menuIndex = 0;\n\n    const firstItem = this.getItemByIndex(this.menuIndex);\n    if (firstItem && firstItem.isFocusable()) {\n      this.focusItem(firstItem);\n    } else {\n      this.focusNextItem();\n    }\n  }\n\n  public focusPreviousItem() {\n    if (!this.hasFocusableItems) {\n      return;\n    }\n\n    this.menuIndex--;\n\n    const previousItem = this.getItemByIndex(this.menuIndex);\n    if (previousItem && previousItem.isFocusable()) {\n      this.focusItem(previousItem);\n    } else {\n      this.focusPreviousItem();\n    }\n  }\n\n  public focusNextItem() {\n    if (!this.hasFocusableItems) {\n      return;\n    }\n\n    this.menuIndex++;\n\n    const nextItem = this.getItemByIndex(this.menuIndex);\n    if (nextItem && nextItem.isFocusable()) {\n      this.focusItem(nextItem);\n    } else {\n      this.focusNextItem();\n    }\n  }\n\n  public reset() {\n    this._menuIndex = -1;\n    this.resetItemsActiveState();\n    this.changeDetector.markForCheck();\n  }\n\n  private resetItemsActiveState() {\n    this.menuItems.forEach((item: SkyDropdownItemComponent) => {\n      item.resetState();\n    });\n  }\n\n  private focusItem(item: SkyDropdownItemComponent) {\n    this.resetItemsActiveState();\n    item.focusElement(this.useNativeFocus);\n    this.menuChanges.emit({\n      activeIndex: this.menuIndex\n    });\n  }\n\n  private getItemByIndex(index: number) {\n    return this.menuItems.find((item: any, i: number) => {\n      return (i === index);\n    });\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  selector: 'sky-dropdown-menu',\n  template: `<div class=\"sky-dropdown-menu\">\n  <ng-content>\n  </ng-content>\n</div>\n`,\n  styles: [`.sky-dropdown-menu {\n  display: flex;\n  flex-direction: column;\n}\n\n.sky-dropdown-menu ::ng-deep button {\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n`],\n  changeDetection: ChangeDetectionStrategy.OnPush\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ChangeDetectorRef, },\n{type: SkyDropdownComponent, decorators: [{ type: Optional }, ]},\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'useNativeFocus': [{ type: Input },],\n'menuChanges': [{ type: Output },],\n'menuItems': [{ type: ContentChildren, args: [SkyDropdownItemComponent, ] },],\n'onClick': [{ type: HostListener, args: ['click', ['$event'], ] },],\n'onKeyDown': [{ type: HostListener, args: ['keydown', ['$event'], ] },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}