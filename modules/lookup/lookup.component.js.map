{"version":3,"sources":["../../../.srctemp/modules/lookup/lookup.component.ts"],"names":[],"mappings":"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","file":"lookup.component.js","sourceRoot":"","sourcesContent":["import {\n  AfterContentInit,\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  ElementRef,\n  forwardRef,\n  Input,\n  OnDestroy,\n  ViewChild\n} from '@angular/core';\n\nimport {\n  ControlValueAccessor,\n  NG_VALUE_ACCESSOR\n} from '@angular/forms';\n\nimport { Observable } from 'rxjs/Observable';\nimport 'rxjs/add/observable/fromEvent';\nimport { Subject } from 'rxjs/Subject';\n\nimport {\n  SkyAutocompleteSelectionChange,\n  SkyAutocompleteInputDirective\n} from '../autocomplete';\n\nimport {\n  SkyToken,\n  SkyTokensMessage,\n  SkyTokensMessageType\n} from '../tokens';\n\nimport {\n  SkyWindowRefService\n} from '../window';\n\nimport { SkyLookupAutocompleteAdapter } from './lookup-autocomplete-adapter';\n\n\nexport class SkyLookupComponent\n  extends SkyLookupAutocompleteAdapter\n  implements AfterContentInit, OnDestroy, ControlValueAccessor {\n\n  \n  public ariaLabel: string;\n\n  \n  public ariaLabelledBy: string;\n\n  \n  public disabled = false;\n\n  \n  public placeholderText: string;\n\n  public get tokens(): SkyToken[] {\n    return this._tokens;\n  }\n\n  public set tokens(value: SkyToken[]) {\n    this._tokens = value;\n    this.onChange(this.value);\n    this.onTouched();\n  }\n\n  public get value(): any[] {\n    if (!this.tokens) {\n      return [];\n    }\n\n    return this.tokens.map(token => token.value);\n  }\n\n  public isInputFocused = false;\n  public tokensController = new Subject<SkyTokensMessage>();\n\n  \n  private autocompleteInputDirective: SkyAutocompleteInputDirective;\n\n  \n  private lookupInput: ElementRef;\n\n  private ngUnsubscribe = new Subject();\n  private idle = new Subject();\n  private markForTokenFocusOnKeyUp = false;\n\n  private _tokens: SkyToken[];\n\n  constructor(\n    private changeDetector: ChangeDetectorRef,\n    private elementRef: ElementRef,\n    private windowRef: SkyWindowRefService\n  ) {\n    super();\n  }\n\n  public ngAfterContentInit() {\n    if (!this.disabled) {\n      this.addEventListeners();\n    }\n  }\n\n  public ngOnDestroy() {\n    this.removeEventListeners();\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n    this.tokensController.complete();\n  }\n\n  public onAutocompleteSelectionChange(change: SkyAutocompleteSelectionChange) {\n    this.addToSelected(change.selectedItem);\n    this.focusInput();\n  }\n\n  public onTokensChange(change: SkyToken[]) {\n    if (!change) {\n      return;\n    }\n\n    if (change.length === 0) {\n      this.focusInput();\n    }\n\n    if (this.tokens !== change) {\n      this.tokens = change;\n    }\n  }\n\n  public onTokensFocusIndexOverRange() {\n    this.windowRef.getWindow().setTimeout(() => {\n      this.focusInput();\n    });\n  }\n\n  public onTokensKeyUp(event: KeyboardEvent) {\n    const key = event.key.toLowerCase();\n    if (key === 'backspace') {\n      this.sendTokensMessage(SkyTokensMessageType.RemoveActiveToken);\n      this.sendTokensMessage(SkyTokensMessageType.FocusPreviousToken);\n      event.preventDefault();\n    }\n\n    if (key === 'delete') {\n      this.sendTokensMessage(SkyTokensMessageType.RemoveActiveToken);\n      this.windowRef.getWindow().setTimeout(() => {\n        this.sendTokensMessage(SkyTokensMessageType.FocusActiveToken);\n      });\n      event.preventDefault();\n    }\n  }\n\n  public writeValue(value: any[]) {\n    if (value && !this.disabled) {\n      const copy = this.cloneItems(value);\n      this.tokens = this.parseTokens(copy);\n    }\n  }\n\n  // Angular automatically constructs these methods.\n  /* istanbul ignore next */\n  public onChange = (value: any[]) => {};\n  /* istanbul ignore next */\n  public onTouched = () => {};\n\n  public registerOnChange(fn: (value: any) => void) {\n    this.onChange = fn;\n  }\n\n  public registerOnTouched(fn: () => void) {\n    this.onTouched = fn;\n  }\n\n  // Allows Angular to disable the input.\n  public setDisabledState(disabled: boolean) {\n    this.removeEventListeners();\n\n    if (!disabled) {\n      this.addEventListeners();\n    }\n\n    this.disabled = disabled;\n    this.changeDetector.markForCheck();\n  }\n\n  public clearSearchText() {\n    this.autocompleteInputDirective.value = undefined;\n  }\n\n  private addToSelected(item: any) {\n    let selectedItems: any[] = [];\n\n    if (this.tokens) {\n      selectedItems = this.tokens.map(token => token.value);\n    }\n\n    // Add the new item.\n    selectedItems = selectedItems.concat(item);\n\n    this.writeValue(selectedItems);\n    this.clearSearchText();\n  }\n\n  private addEventListeners() {\n    this.idle = new Subject();\n    this.focusTokensOnInputKeyUp();\n    this.focusInputOnHostClick();\n  }\n\n  private removeEventListeners() {\n    this.idle.next();\n    this.idle.complete();\n  }\n\n  private focusTokensOnInputKeyUp() {\n    const inputElement = this.lookupInput.nativeElement;\n\n    // Handles when to focus on the tokens.\n    // Check for empty search text on keydown, before the escape key is fully pressed.\n    // (Otherwise, a single character being escaped would register as empty on keyup.)\n    // If empty on keydown, set a flag so that the appropriate action can be taken on keyup.\n\n    Observable\n      .fromEvent(inputElement, 'keydown')\n      .takeUntil(this.idle)\n      .subscribe((event: KeyboardEvent) => {\n        const key = event.key.toLowerCase();\n        if (\n          key === 'left' ||\n          key === 'arrowleft' ||\n          key === 'backspace'\n        ) {\n          const isSearchEmpty = (!this.lookupInput.nativeElement.value);\n          if (isSearchEmpty) {\n            this.markForTokenFocusOnKeyUp = true;\n          } else {\n            this.markForTokenFocusOnKeyUp = false;\n          }\n        }\n      });\n\n    Observable\n      .fromEvent(inputElement, 'keyup')\n      .takeUntil(this.idle)\n      .subscribe((event: KeyboardEvent) => {\n        const key = event.key.toLowerCase();\n        if (\n          key === 'left' ||\n          key === 'arrowleft' ||\n          key === 'backspace'\n        ) {\n          /* istanbul ignore else */\n          if (this.markForTokenFocusOnKeyUp) {\n            this.sendTokensMessage(SkyTokensMessageType.FocusLastToken);\n            event.preventDefault();\n          }\n        }\n\n        event.stopPropagation();\n      });\n  }\n\n  private focusInputOnHostClick() {\n    const hostElement = this.elementRef.nativeElement;\n    const documentObj = this.windowRef.getWindow().document;\n\n    // Handles focusing the input when the host is clicked.\n    // The input should NOT be focused if other elements (tokens, etc.)\n    // are currently focused or being tabbed through.\n\n    Observable\n      .fromEvent(documentObj, 'mousedown')\n      .takeUntil(this.idle)\n      .subscribe((event: MouseEvent) => {\n        this.isInputFocused = hostElement.contains(event.target);\n      });\n\n    Observable\n      .fromEvent(documentObj, 'focusin')\n      .takeUntil(this.idle)\n      .subscribe((event: KeyboardEvent) => {\n        this.isInputFocused = hostElement.contains(event.target);\n      });\n\n    Observable\n      .fromEvent(hostElement, 'mouseup')\n      .takeUntil(this.idle)\n      .subscribe(() => {\n        const classList = documentObj.activeElement.classList;\n        if (!classList || !classList.contains('sky-token')) {\n          this.focusInput();\n        }\n      });\n  }\n\n  private focusInput() {\n    this.lookupInput.nativeElement.focus();\n  }\n\n  private cloneItems(items: any[]): any[] {\n    return items.map(item => {\n      return { ...item };\n    });\n  }\n\n  private parseTokens(data: any[]): SkyToken[] {\n    return data.map((item: any) => {\n      return {\n        value: item\n      };\n    });\n  }\n\n  private sendTokensMessage(type: SkyTokensMessageType) {\n    this.tokensController.next({ type });\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  selector: 'sky-lookup',\n  template: `<div\n  class=\"sky-lookup\"\n  [ngClass]=\"{\n    'sky-lookup-focused': isInputFocused,\n    'sky-lookup-disabled': disabled\n  }\">\n  <sky-autocomplete\n    [data]=\"data\"\n    [descriptorProperty]=\"descriptorProperty\"\n    [propertiesToSearch]=\"propertiesToSearch\"\n    [search]=\"search\"\n    [searchFilters]=\"searchFilters\"\n    [searchResultsLimit]=\"searchResultsLimit\"\n    [searchResultTemplate]=\"searchResultTemplate\"\n    [searchTextMinimumCharacters]=\"searchTextMinimumCharacters\"\n    (selectionChange)=\"onAutocompleteSelectionChange($event)\">\n\n    <div class=\"sky-lookup-search sky-form-control\">\n      <sky-tokens\n        [disabled]=\"disabled\"\n        [displayWith]=\"descriptorProperty\"\n        [focusable]=\"false\"\n        [messageStream]=\"tokensController\"\n        [tokens]=\"tokens\"\n        (keyup)=\"onTokensKeyUp($event)\"\n        (tokensChange)=\"onTokensChange($event)\"\n        (focusIndexOverRange)=\"onTokensFocusIndexOverRange()\">\n\n        <textarea\n          skyAutocomplete\n          class=\"sky-form-control\"\n          [disabled]=\"disabled\"\n          [attr.aria-label]=\"ariaLabel\"\n          [attr.aria-labelledby]=\"ariaLabelledBy\"\n          [attr.placeholder]=\"placeholderText\"\n          (keydown.enter)=\"$event.preventDefault();\"\n          (keyup.escape)=\"clearSearchText();$event.preventDefault();\"\n          (keyup.delete)=\"$event.stopPropagation();\"\n          #lookupInput>\n        </textarea>\n      </sky-tokens>\n    </div>\n  </sky-autocomplete>\n</div>\n`,\n  styles: [`.sky-lookup textarea {\n  resize: none;\n  border: 0;\n  overflow: hidden;\n  height: 1.42857em;\n  box-sizing: content-box;\n  padding: 0;\n  display: inline-flex;\n  background-color: transparent;\n}\n\n.sky-lookup textarea:focus {\n  outline: none;\n  box-shadow: none;\n}\n\n.sky-lookup ::ng-deep\nsky-tokens:focus {\n  outline: none;\n}\n\n.sky-lookup ::ng-deep\nsky-tokens .sky-tokens {\n  margin-top: -5px;\n  margin-bottom: -5px;\n}\n\n.sky-lookup ::ng-deep\nsky-tokens .sky-tokens .sky-tokens-content {\n  padding-top: 5px;\n  padding-bottom: 5px;\n  padding-left: 11px;\n  flex-basis: 100px;\n}\n\n.sky-lookup-search {\n  cursor: text;\n  background-color: #ffffff;\n  padding-left: 3px;\n}\n\n.sky-lookup-disabled .sky-lookup-search {\n  cursor: default;\n}\n\n.sky-lookup-focused .sky-lookup-search {\n  box-shadow: 0 0 8px rgba(0, 180, 241, 0.6);\n  border: 1px solid #00b4f1;\n  outline: none;\n}\n\n.sky-lookup-focused ::ng-deep .sky-tokens-content {\n  flex-basis: 100px;\n}\n`],\n  providers: [{\n    provide: NG_VALUE_ACCESSOR,\n    /* tslint:disable-next-line:no-forward-ref */\n    useExisting: forwardRef(() => SkyLookupComponent),\n    multi: true\n  }],\n  changeDetection: ChangeDetectionStrategy.OnPush\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ChangeDetectorRef, },\n{type: ElementRef, },\n{type: SkyWindowRefService, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'ariaLabel': [{ type: Input },],\n'ariaLabelledBy': [{ type: Input },],\n'disabled': [{ type: Input },],\n'placeholderText': [{ type: Input },],\n'autocompleteInputDirective': [{ type: ViewChild, args: [SkyAutocompleteInputDirective, ] },],\n'lookupInput': [{ type: ViewChild, args: ['lookupInput', ] },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}